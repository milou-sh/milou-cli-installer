# Milou Environment Configuration Template
# ========================================
# This file is a template for .env configuration
# Copy this file to .env and fill in your actual values
#
# IMPORTANT: Never commit .env to version control!
# The .env file contains sensitive credentials and should have 600 permissions

# Environment Type
# ----------------------------------------
# Options: development, production
NODE_ENV=production

# Milou Version
# ----------------------------------------
# Image version to use from GHCR
# - ALWAYS use specific version number (e.g., '1.0.0')
# - Run './milou check-updates' to see if updates are available
# - Run './milou version latest' to get latest version number
# - NEVER use 'latest' tag (ambiguous and prevents update detection)
MILOU_VERSION=1.0.0

# Server & Domain Configuration
# ----------------------------------------
# Domain name for your Milou installation
DOMAIN=localhost
SERVER_NAME=localhost

# SSL Configuration
# ----------------------------------------
SSL_PORT=443
SSL_CERT_PATH=./ssl
# For Let's Encrypt: SSL_CERT_PATH=/etc/letsencrypt/live/your.domain.com

# CORS Configuration
# ----------------------------------------
CORS_ORIGIN=http://localhost
# For production: CORS_ORIGIN=https://your.domain.com

# Database Configuration
# ----------------------------------------
# For Docker: use service name 'database'
# For local dev: use 'localhost'
DB_HOST=database
DB_PORT=5432
DB_USER=milou
DB_PASSWORD=REPLACE_DB_PASSWORD
DB_NAME=milou
DATABASE_URI=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# PostgreSQL (for database container)
# ----------------------------------------
# Note: These must match DB_* values above
POSTGRES_USER=milou
POSTGRES_PASSWORD=REPLACE_DB_PASSWORD
POSTGRES_DB=milou

# Redis Configuration
# ----------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=REPLACE_REDIS_PASSWORD
REDIS_SESSION_TTL=3600
REDIS_MAX_RETRIES=3
REDIS_CONNECT_TIMEOUT=10000
REDIS_CLEANUP_ENABLED=true
REDIS_CLEANUP_INTERVAL=3600

# RabbitMQ Configuration
# ----------------------------------------
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USER=milou
RABBITMQ_PASSWORD=REPLACE_RABBITMQ_PASSWORD
RABBITMQ_ERLANG_COOKIE=REPLACE_ERLANG_COOKIE
RABBITMQ_URL=REPLACE_RABBITMQ_URL

# Engine Configuration
# ----------------------------------------
# URL for the rendering engine service
# For Docker: http://engine:8089
# For local development: http://localhost:8089
ENGINE_URL=http://engine:8089

# GitHub Container Registry
# ----------------------------------------
# Personal Access Token with read:packages scope (required)
# Milou service images are private; pulls will fail without this token
# Get token from: https://github.com/settings/tokens/new
GHCR_TOKEN=REPLACE_GHCR_TOKEN

# AI Keys (Optional - for AI features)
# ----------------------------------------
AZURE_OPENAI_API_KEY=your_azure_openai_key
OPENAI_ENDPOINT=your_openai_endpoint
OPENAI_API_KEY=your_openai_api_key

# Azure Authentication (OAuth - Optional)
# ----------------------------------------
AZURE_CLIENT_ID=your_azure_client_id
AZURE_CLIENT_SECRET=your_azure_client_secret
AZURE_TENANT_ID=your_azure_tenant_id
APP_URL=http://localhost:5173/

# Security & Secrets
# ----------------------------------------
# These should be randomly generated 64-character hex strings
# Run: openssl rand -hex 64
SESSION_SECRET=REPLACE_SESSION_SECRET
ENCRYPTION_KEY=REPLACE_ENCRYPTION_KEY
JWT_SECRET=REPLACE_JWT_SECRET

# Integration SSL Configuration
# ----------------------------------------
# Allow self-signed SSL certificates for integrations (Ghostwriter, PwnDoc, etc.)
# Set to 'true' for development/staging environments with self-signed certificates
# SECURITY WARNING: Only enable this for trusted internal servers
# ALLOW_SELF_SIGNED_CERTS=true

# PgAdmin Configuration (Optional - for database admin)
# ----------------------------------------
PGADMIN_EMAIL=admin@admin.com
PGADMIN_PASSWORD=REPLACE_PGADMIN_PASSWORD

# Admin User Configuration
# ----------------------------------------
# First admin user credentials for Milou application
# IMPORTANT: Change password after first login!
# Auto-generated during setup
ADMIN_EMAIL=admin@localhost
ADMIN_PASSWORD=REPLACE_ADMIN_PASSWORD
ADMIN_USERNAME=admin

# Application Configuration
# ----------------------------------------
PORT=3000
LOG_LEVEL=info

# Frontend Configuration
# ----------------------------------------
VITE_API_URL=/api

# ========================================
# NOTES:
# ========================================
#
# 1. Replace all REPLACE_* placeholders with actual values
# 2. Use 'milou setup' to generate this file automatically with secure defaults
# 3. Use 'milou config set KEY VALUE' to safely update individual values
# 4. Use 'milou config validate' to check if all required values are set
# 5. Keep this file secure with 600 permissions (owner read/write only)
#
# Quick Setup:
#   ./milou setup           # Interactive wizard
#   ./milou setup quick     # Non-interactive with defaults
#
# GHCR Authentication:
#   ./milou ghcr setup      # Interactive GHCR token setup
#   ./milou ghcr login      # Login with token from .env
#
# Configuration Management:
#   ./milou config get KEY              # Get a value
#   ./milou config set KEY VALUE        # Set a value
#   ./milou config show                 # Show all configuration
#   ./milou config validate             # Validate required values
#   ./milou config migrate              # Migrate old .env format
